Loading rhel8/default-amp
  Loading requirement: dot rhel8/slurm singularity/current rhel8/global
    cuda/11.4 libpciaccess/0.16/gcc-9.4.0-6fonbj6
    libiconv/1.16/gcc-9.4.0-ahebbov libxml2/2.9.12/gcc-9.4.0-gnknt5e
    ncurses/6.2/gcc-9.4.0-aiirok7 hwloc/2.5.0/gcc-9.4.0-7sqomga
    libevent/2.1.12/gcc-9.4.0-hgny7cm numactl/2.0.14/gcc-9.4.0-52dwc6n
    cuda/11.4.0/gcc-9.4.0-3hnxhjt gdrcopy/2.2/gcc-9.4.0-e4igtfp
    knem/1.1.4/gcc-9.4.0-bpbxgva libnl/3.3.0/gcc-9.4.0-whwhrwb
    rdma-core/34.0/gcc-9.4.0-5eo5n2u ucx/1.11.1/gcc-9.4.0-lktqyl4
    openmpi/4.1.1/gcc-9.4.0-epagguv
Changed directory to /rds/user/nc630/hpc-work/MLMI4/latent-bottlenecked-anp/contextual_bandits.

JobID: 45238723
======
Time: Thu Feb 22 00:56:24 GMT 2024
Running on master node: gpu-q-24
Current directory: /rds/user/nc630/hpc-work/MLMI4/latent-bottlenecked-anp/contextual_bandits

Nodes allocated:
================
gpu-q-24

numtasks=1, numnodes=1, mpi_tasks_per_node=1 (OMP_NUM_THREADS=1)

Executing command:
==================
python3 main.py --expid tnpd-default --cmab_mode train --num_epochs 2000 > logs/out.45238723

Experiment: Bandit Train | tnpd-default
Device: cuda

Total number of parameters: 15530

  0%|          | 0/2000 [00:00<?, ?it/s]  0%|          | 1/2000 [00:00<15:01,  2.22it/s]  0%|          | 10/2000 [00:00<01:27, 22.73it/s]  1%|          | 19/2000 [00:00<00:51, 38.60it/s]  1%|▏         | 28/2000 [00:00<00:38, 50.57it/s]  2%|▏         | 37/2000 [00:00<00:32, 59.57it/s]  2%|▏         | 46/2000 [00:01<00:29, 66.12it/s]  3%|▎         | 55/2000 [00:01<00:27, 70.47it/s]  3%|▎         | 64/2000 [00:01<00:26, 73.78it/s]  4%|▎         | 73/2000 [00:01<00:25, 75.92it/s]  4%|▍         | 82/2000 [00:01<00:24, 77.22it/s]  5%|▍         | 91/2000 [00:01<00:24, 78.73it/s]  5%|▌         | 100/2000 [00:01<00:23, 79.39it/s]  5%|▌         | 109/2000 [00:01<00:23, 80.29it/s]  6%|▌         | 118/2000 [00:01<00:23, 80.92it/s]  6%|▋         | 127/2000 [00:01<00:23, 81.38it/s]  7%|▋         | 136/2000 [00:02<00:22, 81.69it/s]  7%|▋         | 145/2000 [00:02<00:22, 81.91it/s]  8%|▊         | 154/2000 [00:02<00:22, 82.05it/s]  8%|▊         | 163/2000 [00:02<00:22, 82.18it/s]  9%|▊         | 172/2000 [00:02<00:22, 82.27it/s]  9%|▉         | 181/2000 [00:02<00:22, 82.28it/s] 10%|▉         | 190/2000 [00:02<00:22, 82.26it/s] 10%|▉         | 199/2000 [00:02<00:21, 82.31it/s][model] TNPD-S0-B8 [step] 200 [lr] 4.878e-04 [train_loss] loss 121.4241 (2.884 secs)
 10%|█         | 208/2000 [00:02<00:21, 82.22it/s] 11%|█         | 217/2000 [00:03<00:21, 82.34it/s] 11%|█▏        | 226/2000 [00:03<00:21, 82.27it/s] 12%|█▏        | 235/2000 [00:03<00:21, 82.32it/s] 12%|█▏        | 244/2000 [00:03<00:21, 82.34it/s] 13%|█▎        | 253/2000 [00:03<00:21, 82.35it/s] 13%|█▎        | 262/2000 [00:03<00:21, 82.39it/s] 14%|█▎        | 271/2000 [00:03<00:20, 82.35it/s] 14%|█▍        | 280/2000 [00:03<00:21, 81.68it/s] 14%|█▍        | 289/2000 [00:03<00:20, 81.50it/s] 15%|█▍        | 298/2000 [00:04<00:20, 81.75it/s] 15%|█▌        | 307/2000 [00:04<00:20, 81.97it/s] 16%|█▌        | 316/2000 [00:04<00:20, 82.07it/s] 16%|█▋        | 325/2000 [00:04<00:20, 82.17it/s] 17%|█▋        | 334/2000 [00:04<00:20, 82.24it/s] 17%|█▋        | 343/2000 [00:04<00:20, 82.30it/s] 18%|█▊        | 352/2000 [00:04<00:20, 82.35it/s] 18%|█▊        | 361/2000 [00:04<00:19, 82.35it/s] 18%|█▊        | 370/2000 [00:04<00:19, 82.14it/s] 19%|█▉        | 379/2000 [00:05<00:19, 82.00it/s] 19%|█▉        | 388/2000 [00:05<00:19, 82.11it/s] 20%|█▉        | 397/2000 [00:05<00:19, 82.21it/s][model] TNPD-S0-B8 [step] 400 [lr] 4.523e-04 [train_loss] loss 15.5443 (2.435 secs)
 20%|██        | 406/2000 [00:05<00:19, 82.09it/s] 21%|██        | 415/2000 [00:05<00:19, 82.15it/s] 21%|██        | 424/2000 [00:05<00:19, 82.21it/s] 22%|██▏       | 433/2000 [00:05<00:19, 81.93it/s] 22%|██▏       | 442/2000 [00:05<00:19, 81.98it/s] 23%|██▎       | 451/2000 [00:05<00:18, 82.14it/s] 23%|██▎       | 460/2000 [00:06<00:18, 81.96it/s] 23%|██▎       | 469/2000 [00:06<00:18, 82.12it/s] 24%|██▍       | 478/2000 [00:06<00:18, 81.97it/s] 24%|██▍       | 487/2000 [00:06<00:18, 82.09it/s] 25%|██▍       | 496/2000 [00:06<00:18, 82.14it/s] 25%|██▌       | 505/2000 [00:06<00:18, 82.29it/s] 26%|██▌       | 514/2000 [00:06<00:18, 82.34it/s] 26%|██▌       | 523/2000 [00:06<00:17, 82.35it/s] 27%|██▋       | 532/2000 [00:06<00:17, 82.35it/s] 27%|██▋       | 541/2000 [00:07<00:17, 82.13it/s] 28%|██▊       | 550/2000 [00:07<00:17, 82.00it/s] 28%|██▊       | 559/2000 [00:07<00:17, 81.90it/s] 28%|██▊       | 568/2000 [00:07<00:17, 82.06it/s] 29%|██▉       | 577/2000 [00:07<00:17, 82.11it/s] 29%|██▉       | 586/2000 [00:07<00:17, 82.20it/s] 30%|██▉       | 595/2000 [00:07<00:17, 82.15it/s][model] TNPD-S0-B8 [step] 600 [lr] 3.969e-04 [train_loss] loss 14.2667 (2.434 secs)
 30%|███       | 604/2000 [00:07<00:17, 81.95it/s] 31%|███       | 613/2000 [00:07<00:16, 82.13it/s] 31%|███       | 622/2000 [00:08<00:16, 82.21it/s] 32%|███▏      | 631/2000 [00:08<00:16, 82.23it/s] 32%|███▏      | 640/2000 [00:08<00:16, 82.08it/s] 32%|███▏      | 649/2000 [00:08<00:16, 82.18it/s] 33%|███▎      | 658/2000 [00:08<00:16, 81.88it/s] 33%|███▎      | 667/2000 [00:08<00:16, 81.95it/s] 34%|███▍      | 676/2000 [00:08<00:16, 82.07it/s] 34%|███▍      | 685/2000 [00:08<00:16, 81.96it/s] 35%|███▍      | 694/2000 [00:08<00:15, 81.89it/s] 35%|███▌      | 703/2000 [00:09<00:15, 82.04it/s] 36%|███▌      | 712/2000 [00:09<00:15, 82.12it/s] 36%|███▌      | 721/2000 [00:09<00:15, 82.22it/s] 36%|███▋      | 730/2000 [00:09<00:15, 82.29it/s] 37%|███▋      | 739/2000 [00:09<00:15, 82.30it/s] 37%|███▋      | 748/2000 [00:09<00:15, 82.12it/s] 38%|███▊      | 757/2000 [00:09<00:15, 81.97it/s] 38%|███▊      | 766/2000 [00:09<00:15, 81.88it/s] 39%|███▉      | 775/2000 [00:09<00:14, 81.82it/s] 39%|███▉      | 784/2000 [00:09<00:14, 81.77it/s] 40%|███▉      | 793/2000 [00:10<00:14, 81.75it/s][model] TNPD-S0-B8 [step] 800 [lr] 3.273e-04 [train_loss] loss 12.9502 (2.440 secs)
 40%|████      | 802/2000 [00:10<00:14, 81.72it/s] 41%|████      | 811/2000 [00:10<00:14, 81.92it/s] 41%|████      | 820/2000 [00:10<00:14, 81.84it/s] 41%|████▏     | 829/2000 [00:10<00:14, 82.02it/s] 42%|████▏     | 838/2000 [00:10<00:14, 81.97it/s] 42%|████▏     | 847/2000 [00:10<00:14, 82.06it/s] 43%|████▎     | 856/2000 [00:10<00:13, 82.16it/s] 43%|████▎     | 865/2000 [00:10<00:13, 82.26it/s] 44%|████▎     | 874/2000 [00:11<00:13, 82.29it/s] 44%|████▍     | 883/2000 [00:11<00:13, 82.31it/s] 45%|████▍     | 892/2000 [00:11<00:13, 82.12it/s] 45%|████▌     | 901/2000 [00:11<00:13, 81.98it/s] 46%|████▌     | 910/2000 [00:11<00:13, 82.06it/s] 46%|████▌     | 919/2000 [00:11<00:13, 82.05it/s] 46%|████▋     | 928/2000 [00:11<00:13, 82.12it/s] 47%|████▋     | 937/2000 [00:11<00:12, 82.17it/s] 47%|████▋     | 946/2000 [00:11<00:12, 82.24it/s] 48%|████▊     | 955/2000 [00:12<00:12, 82.09it/s] 48%|████▊     | 964/2000 [00:12<00:12, 82.18it/s] 49%|████▊     | 973/2000 [00:12<00:12, 82.19it/s] 49%|████▉     | 982/2000 [00:12<00:12, 82.14it/s] 50%|████▉     | 991/2000 [00:12<00:12, 82.19it/s][model] TNPD-S0-B8 [step] 1000 [lr] 2.500e-04 [train_loss] loss 11.0003 (2.434 secs)
 50%|█████     | 1000/2000 [00:12<00:12, 79.96it/s] 50%|█████     | 1009/2000 [00:12<00:12, 80.58it/s] 51%|█████     | 1018/2000 [00:12<00:12, 81.13it/s] 51%|█████▏    | 1027/2000 [00:12<00:11, 81.47it/s] 52%|█████▏    | 1036/2000 [00:13<00:11, 81.37it/s] 52%|█████▏    | 1045/2000 [00:13<00:11, 81.46it/s] 53%|█████▎    | 1054/2000 [00:13<00:11, 81.70it/s] 53%|█████▎    | 1063/2000 [00:13<00:11, 81.70it/s] 54%|█████▎    | 1072/2000 [00:13<00:11, 81.89it/s] 54%|█████▍    | 1081/2000 [00:13<00:11, 81.83it/s] 55%|█████▍    | 1090/2000 [00:13<00:11, 82.02it/s] 55%|█████▍    | 1099/2000 [00:13<00:11, 81.87it/s] 55%|█████▌    | 1108/2000 [00:13<00:10, 81.81it/s] 56%|█████▌    | 1117/2000 [00:14<00:10, 81.99it/s] 56%|█████▋    | 1126/2000 [00:14<00:10, 82.11it/s] 57%|█████▋    | 1135/2000 [00:14<00:10, 82.12it/s] 57%|█████▋    | 1144/2000 [00:14<00:10, 82.11it/s] 58%|█████▊    | 1153/2000 [00:14<00:10, 82.17it/s] 58%|█████▊    | 1162/2000 [00:14<00:10, 82.22it/s] 59%|█████▊    | 1171/2000 [00:14<00:10, 82.07it/s] 59%|█████▉    | 1180/2000 [00:14<00:09, 82.21it/s] 59%|█████▉    | 1189/2000 [00:14<00:09, 82.24it/s] 60%|█████▉    | 1198/2000 [00:15<00:09, 82.29it/s][model] TNPD-S0-B8 [step] 1200 [lr] 1.727e-04 [train_loss] loss 8.6278 (2.447 secs)
 60%|██████    | 1207/2000 [00:15<00:09, 81.96it/s] 61%|██████    | 1216/2000 [00:15<00:09, 82.00it/s] 61%|██████▏   | 1225/2000 [00:15<00:09, 81.90it/s] 62%|██████▏   | 1234/2000 [00:15<00:09, 81.64it/s] 62%|██████▏   | 1243/2000 [00:15<00:09, 81.88it/s] 63%|██████▎   | 1252/2000 [00:15<00:09, 81.92it/s] 63%|██████▎   | 1261/2000 [00:15<00:09, 81.92it/s] 64%|██████▎   | 1270/2000 [00:15<00:08, 81.91it/s] 64%|██████▍   | 1279/2000 [00:16<00:08, 81.77it/s] 64%|██████▍   | 1288/2000 [00:16<00:08, 81.73it/s] 65%|██████▍   | 1297/2000 [00:16<00:08, 81.72it/s] 65%|██████▌   | 1306/2000 [00:16<00:08, 81.92it/s] 66%|██████▌   | 1315/2000 [00:16<00:08, 82.07it/s] 66%|██████▌   | 1324/2000 [00:16<00:08, 82.17it/s] 67%|██████▋   | 1333/2000 [00:16<00:08, 82.25it/s] 67%|██████▋   | 1342/2000 [00:16<00:08, 82.24it/s] 68%|██████▊   | 1351/2000 [00:16<00:07, 82.25it/s] 68%|██████▊   | 1360/2000 [00:17<00:07, 81.67it/s] 68%|██████▊   | 1369/2000 [00:17<00:07, 81.76it/s] 69%|██████▉   | 1378/2000 [00:17<00:07, 81.80it/s] 69%|██████▉   | 1387/2000 [00:17<00:07, 81.86it/s] 70%|██████▉   | 1396/2000 [00:17<00:07, 81.82it/s][model] TNPD-S0-B8 [step] 1400 [lr] 1.031e-04 [train_loss] loss 6.8522 (2.442 secs)
 70%|███████   | 1405/2000 [00:17<00:07, 81.77it/s] 71%|███████   | 1414/2000 [00:17<00:07, 81.96it/s] 71%|███████   | 1423/2000 [00:17<00:07, 82.11it/s] 72%|███████▏  | 1432/2000 [00:17<00:06, 81.32it/s] 72%|███████▏  | 1441/2000 [00:18<00:06, 81.40it/s] 72%|███████▎  | 1450/2000 [00:18<00:06, 81.70it/s] 73%|███████▎  | 1459/2000 [00:18<00:06, 81.91it/s] 73%|███████▎  | 1468/2000 [00:18<00:06, 81.83it/s] 74%|███████▍  | 1477/2000 [00:18<00:06, 81.77it/s] 74%|███████▍  | 1486/2000 [00:18<00:06, 81.76it/s] 75%|███████▍  | 1495/2000 [00:18<00:06, 81.94it/s] 75%|███████▌  | 1504/2000 [00:18<00:06, 81.86it/s] 76%|███████▌  | 1513/2000 [00:18<00:05, 82.02it/s] 76%|███████▌  | 1522/2000 [00:19<00:05, 82.09it/s] 77%|███████▋  | 1531/2000 [00:19<00:05, 82.02it/s] 77%|███████▋  | 1540/2000 [00:19<00:05, 81.90it/s] 77%|███████▋  | 1549/2000 [00:19<00:05, 81.84it/s] 78%|███████▊  | 1558/2000 [00:19<00:05, 82.01it/s] 78%|███████▊  | 1567/2000 [00:19<00:05, 82.12it/s] 79%|███████▉  | 1576/2000 [00:19<00:05, 81.98it/s] 79%|███████▉  | 1585/2000 [00:19<00:05, 81.89it/s] 80%|███████▉  | 1594/2000 [00:19<00:04, 81.83it/s][model] TNPD-S0-B8 [step] 1600 [lr] 4.775e-05 [train_loss] loss 5.8840 (2.444 secs)
 80%|████████  | 1603/2000 [00:19<00:04, 81.56it/s] 81%|████████  | 1612/2000 [00:20<00:04, 81.80it/s] 81%|████████  | 1621/2000 [00:20<00:04, 81.72it/s] 82%|████████▏ | 1630/2000 [00:20<00:04, 81.54it/s] 82%|████████▏ | 1639/2000 [00:20<00:04, 81.37it/s] 82%|████████▏ | 1648/2000 [00:20<00:04, 81.44it/s] 83%|████████▎ | 1657/2000 [00:20<00:04, 81.51it/s] 83%|████████▎ | 1666/2000 [00:20<00:04, 81.76it/s] 84%|████████▍ | 1675/2000 [00:20<00:03, 81.98it/s] 84%|████████▍ | 1684/2000 [00:20<00:03, 82.08it/s] 85%|████████▍ | 1693/2000 [00:21<00:03, 82.22it/s] 85%|████████▌ | 1702/2000 [00:21<00:03, 82.18it/s] 86%|████████▌ | 1711/2000 [00:21<00:03, 82.13it/s] 86%|████████▌ | 1720/2000 [00:21<00:03, 82.22it/s] 86%|████████▋ | 1729/2000 [00:21<00:03, 82.25it/s] 87%|████████▋ | 1738/2000 [00:21<00:03, 82.31it/s] 87%|████████▋ | 1747/2000 [00:21<00:03, 82.45it/s] 88%|████████▊ | 1756/2000 [00:21<00:02, 82.24it/s] 88%|████████▊ | 1765/2000 [00:21<00:02, 82.12it/s] 89%|████████▊ | 1774/2000 [00:22<00:02, 81.99it/s] 89%|████████▉ | 1783/2000 [00:22<00:02, 82.00it/s] 90%|████████▉ | 1792/2000 [00:22<00:02, 82.12it/s][model] TNPD-S0-B8 [step] 1800 [lr] 1.224e-05 [train_loss] loss 5.4839 (2.438 secs)
 90%|█████████ | 1801/2000 [00:22<00:02, 81.88it/s] 90%|█████████ | 1810/2000 [00:22<00:02, 81.82it/s] 91%|█████████ | 1819/2000 [00:22<00:02, 81.32it/s] 91%|█████████▏| 1828/2000 [00:22<00:02, 81.63it/s] 92%|█████████▏| 1837/2000 [00:22<00:01, 81.65it/s] 92%|█████████▏| 1846/2000 [00:22<00:01, 81.66it/s] 93%|█████████▎| 1855/2000 [00:23<00:01, 81.88it/s] 93%|█████████▎| 1864/2000 [00:23<00:01, 82.04it/s] 94%|█████████▎| 1873/2000 [00:23<00:01, 81.92it/s] 94%|█████████▍| 1882/2000 [00:23<00:01, 81.69it/s] 95%|█████████▍| 1891/2000 [00:23<00:01, 81.44it/s] 95%|█████████▌| 1900/2000 [00:23<00:01, 81.48it/s] 95%|█████████▌| 1909/2000 [00:23<00:01, 81.75it/s] 96%|█████████▌| 1918/2000 [00:23<00:01, 81.94it/s] 96%|█████████▋| 1927/2000 [00:23<00:00, 82.08it/s] 97%|█████████▋| 1936/2000 [00:24<00:00, 81.95it/s] 97%|█████████▋| 1945/2000 [00:24<00:00, 82.09it/s] 98%|█████████▊| 1954/2000 [00:24<00:00, 81.97it/s] 98%|█████████▊| 1963/2000 [00:24<00:00, 82.09it/s] 99%|█████████▊| 1972/2000 [00:24<00:00, 81.97it/s] 99%|█████████▉| 1981/2000 [00:24<00:00, 81.73it/s]100%|█████████▉| 1990/2000 [00:24<00:00, 81.89it/s]100%|█████████▉| 1999/2000 [00:24<00:00, 82.05it/s][model] TNPD-S0-B8 [step] 2000 [lr] 0.000e+00 [train_loss] loss 5.4261 (2.444 secs)
100%|██████████| 2000/2000 [00:24<00:00, 80.48it/s]
